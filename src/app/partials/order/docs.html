<div ng-controller="DocumentsCtrl as documentsModel">
  <table>
    <tbody>
    <tr style="width:50%">
      <td style="width:40%">
        <button class="btn btn-default" ng-click="documentsModel.sendMail()"
                ng-disabled="documentsModel.isReadOnly || documentsModel.order.view.isChanged">
          שלח דוא"ל
        </button>
      </td>
      <td style="width: 30%">
        <a ng-href="#/menu/{{documentsModel.order.id}}"target="_blank">
          הדפס תפריט
        </a>
      </td>
      <td style="width: 30%">
        <a ng-href="#/exitList/{{documentsModel.order.id}}"target="_blank">
          הדפס רשימת יציאה
        </a>
      </td>
    </tr>
    </tbody>
  </table>
  <p></p>
<table style="width: 50%">
  <tbody>
    <tr ng-class="documentsModel.order.view.changes.bidTextType?'myChanged':null">
      <td><label>הצעת מחיר ישנה:</label></td>
        <td><label>טקסט מבוא</label></td>
        <td>
            <select ng-model="documentsModel.order.view.startBidTextType"
                    ng-change="documentsModel.orderChanged('bidTextType')"
                    ng-options="bidTextType.label for bidTextType in documentsModel.bidTextTypes | filter: {documentType: 1}"
                    ng-disabled="documentsModel.isReadOnly"
                    ></select>
        </td>
      <td><label>טקסט סיום</label></td>
      <td>
        <select ng-model="documentsModel.order.view.endBidTextType"
                ng-change="documentsModel.orderChanged('bidTextType')"
                ng-options="bidTextType.label for bidTextType in documentsModel.bidTextTypes | filter: {documentType: 1}"
                ng-disabled="documentsModel.isReadOnly"
          ></select>
      </td>
    </tr>
    </tbody>
</table>
  <p></p>
  <!--
<table>
    <thead>
    <th>
        הזמנה
    </th>
    </thead>
    <tbody>
    <tr ng-repeat="textType in documentsModel.bidTextTypes | filter: {documentType: 2}"
        ng-class="documentsModel.order.view.changes.orderTextType?'myChanged':null">
        <td>
            <input type="checkbox" ng-model="textType.isInclude"
                   ng-change="documentsModel.setOrderDocTextType()">
        </td>
        <td>{{textType.label}}</td>
    </tr>
    </tbody>
</table>
-->

<div ng-hide="documentsModel.order.view.isChanged">
  <label>
    צור מסמך חדש:
  </label>
  <input type="text" placeholder="תיאור מסמך"
         size=50
         ng-model="documentsModel.bidDesc"
         ng-disabled="documentsModel.isReadOnly">
    <span ng-repeat="documentType in documentsModel.documentTypes | filter: {isRealDocumentType: true}">
        <button ng-click="documentsModel.createBid(documentType.id)"
                ng-disabled="documentsModel.isReadOnly || !documentsModel.bidDesc"
                class="btn btn-default">
            {{documentType.label}}
        </button>
   </span>
</div>
  <p></p>
<table style="width: 60%">
  <thead>
  <th style="width: 20%">סוג מסמך</th>
  <th style="width: 20%">תאריך</th>
  <th style="width: 30%">תיאור</th>
  <th style="width: 10%">סכום</th>
  <th style="width: 10%"></th>
  <th style="width: 10%"></th>
  </thead>
  <tbody>
  <tr ng-repeat="bid in documentsModel.bids track by bid.id">
      <td>{{documentsModel.documentTypes[bid.attributes.documentType].label}}</td>
    <td ng-show="bid.attributes.documentType === 1 || bid.attributes.documentType === 2">
      <a ng-href="#/bid/{{bid.attributes.uuid}}" target="_blank">
        {{bid.attributes.date | date: 'dd/MM/yyyy HH:mm'}}
      </a>
    </td>
    <td ng-show="bid.attributes.documentType === 4">
      <a ng-href="#/quote/{{bid.attributes.uuid}}" target="_blank">
        {{bid.attributes.date | date: 'dd/MM/yyyy HH:mm'}}
      </a>
    </td>
    <td ng-show="bid.attributes.documentType===0">
              {{bid.attributes.date | date: 'dd/MM/yyyy HH:mm'}}
      </td>
    <td>{{bid.attributes.desc}}</td>
    <td ng-hide="bid.attributes.order.quotes">  <!-- for bids before the multiple quote era -->
      {{bid.attributes.order.total | currency}}
    </td>
    <td ng-show="bid.attributes.order.quotes">
      {{bid.attributes.order.quotes[bid.attributes.order.activeQuote].total | currency}}
    </td>
      <td>
          <button ng-click="documentsModel.restoreBid(bid)"
                  ng-hide="documentsModel.order.view.isChanged"
                  ng-disabled="documentsModel.isReadOnly"
                  class="btn btn-default btn-sm">
                  שחזר
          </button>
      </td>
      <td>
          <button ng-click="documentsModel.delBid(bid)"
                  ng-disabled="documentsModel.isReadOnly"
                  class="btn btn-default btn-sm">
              מחק
          </button>
      </td>
  </tr>
  </tbody>
</table>
</div>
