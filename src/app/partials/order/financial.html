<div ng-controller="FinancialCtrl as financialModel">
<table>
  <tbody>
  <tr>
    <td><label>ס"ה ביניים</label></td>
    <td></td>
    <td>{{financialModel.order.attributes.subTotal | currency}}</td>
    <td>
      <button ng-click="financialModel.updatePrices()"
              class="btn btn-default">
              עדכן מחירים
      </button>
    </td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.discountCause?'myChanged':null">
    <td><label>סיבת הנחה</label></td>
    <td>
      <select ng-model="financialModel.order.view.discountCause"
              ng-change="financialModel.setDiscountCause()"
              ng-options="discountCause.label for discountCause in financialModel.discountCauses"
              ng-disabled="financialModel.isReadOnly"
          ></select>
    </td>
    <td></td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.discountRate?'myChanged':null">
    <td><label>% הנחה</label></td>
    <td>
      <input type="number" max=100 min = 0 ng-model="financialModel.order.attributes.discountRate"
             ng-disabled="!financialModel.order.view.discountCause.tId>0 || financialModel.isReadOnly"
             ng-change="financialModel.setDiscountRate()"
             ng-class="financialModel.order.view.errors.discountRate?'myError':null">
    </td>
    <td>{{financialModel.order.attributes.discount | currency}}</td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.transportationInclVat?'myChanged':null">
    <td><label>משלוח</label></td>
    <td>
      <input type="text" money size=5 ng-model="financialModel.order.attributes.transportationInclVat"
             ng-change="financialModel.setTransportation()"
             ng-disabled="financialModel.isReadOnly"
             ng-class="financialModel.order.view.errors.transportationInclVat?'myError':null">
    </td>
    <td>{{financialModel.order.attributes.transportation | currency}}</td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.isTransportationBonus?'myChanged':null">
    <td><label>זיכוי משלוח</label></td>
    <td>
      <input type="checkbox" ng-model="financialModel.order.attributes.isTransportationBonus"
             ng-disabled="!financialModel.order.attributes.transportation > 0 || financialModel.isReadOnly"
             ng-change="financialModel.setTransportationBonus()">
    </td>
    <td>{{financialModel.order.attributes.transportationBonus | currency}}</td>
  </tr>
  <tr>
    <td><label>עיגול</label></td>
    <td></td>
    <td>{{financialModel.order.attributes.rounding | currency}}</td>
  </tr>
  <tr>
    <td><label>לפני מע"מ</label></td>
    <td></td>
    <td>{{financialModel.order.attributes.totalBeforeVat | currency}}</td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.isBusinessEvent?'myChanged':null">
    <td>
      <label>
        <span>מע"מ %</span>
        <span>{{financialModel.order.attributes.vatRate*100}}</span>
      </label>
    </td>
    <td>אירוע עסקי?
      <input type="checkbox" ng-model="financialModel.order.attributes.isBusinessEvent"
             ng-change="financialModel.setBusinessEvent()"
             ng-disabled="financialModel.isReadOnly">
    </td>
    <td>{{financialModel.order.attributes.vat | currency}}</td>
  </tr>
  <tr>
    <td><label>לתשלום</label></td>
    <td></td>
    <td>{{financialModel.order.attributes.total | currency}}</td>
    <td>למשתתף:</td>
    <td>{{financialModel.order.attributes.total / financialModel.order.attributes.noOfParticipants | currency}}</td>
  </tr>
  <tr ng-class="financialModel.order.view.changes.fixedPrice?'myChanged':null">
    <td><label>מחיר קבוע</label></td>
    <td>
      <input type="checkbox" ng-model="financialModel.order.attributes.isFixedPrice"
             ng-disabled="financialModel.isReadOnly"
             ng-change="financialModel.orderChanged('fixedPrice')">
    </td>
    <td>
      <input type="text" money size=5 ng-model="financialModel.order.attributes.fixedPrice"
             ng-disabled="financialModel.isReadOnly || !financialModel.order.attributes.isFixedPrice"
             ng-change="financialModel.setFixedPrice()"
             ng-class="financialModel.order.view.errors.fixedPrice?'myError':null">
    </td>
  </tr>
  </tbody>
</table>
</div>
