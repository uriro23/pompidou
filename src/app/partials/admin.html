<div style="margin-right: 1%">
<h2>ניהול</h2>
<div>
  <!--
  <button class="btn btn-default" ng-click="adminModel.createNewQuoteData()">הסב להצעות מחיר חדשות</button>
  <button class="btn btn-default" ng-click="adminModel.dropOldQuoteData()">מחק נתוני הצעות מחיר ישנות</button>
  <button class="btn btn-default" ng-click="adminModel.createOrderHeaders()">צור כותרת אירוע</button>
  <button class="btn btn-default" ng-click="adminModel.prepareMultipleQuotes()">הכן ריבוי ציטוטים</button>
  <button class="btn btn-default" ng-click="adminModel.generateProductNames()">צור שמות מוצרים</button>
  <button class="btn btn-default" ng-click="adminModel.productNamesInItems()">שמות מוצרים בפריטי אירוע</button>
  <button class="btn-default" ng-click="adminModel.addQuoteTitles()">כותרות</button>
  <button class="btn-default" ng-click="adminModel.delPriceIncrease()">תוספת מחיר</button>
  <button class="btn-default" ng-click="adminModel.addMenuTypeToHeader()">הוסף סוג תפריט לפרטי כותרת</button>
  <button class="btn-default" ng-click="adminModel.handleForcedPrices()">מחירים כפויים</button>
  <button class="btn-default" ng-click="adminModel.handleHeavyweight()">תפריטים קלים וכבדים</button>
  <button class="btn-default" ng-click="adminModel.handlePackageMeasurementUnit()">יח מידה לאריזה</button>
  <button class="btn-default" ng-click="adminModel.handleEmpBonuses()">בונוסים</button>
  <button class="btn btn-default" ng-click="adminModel.generateStickerLabels()">צור שמות מדבקות</button>
  <button class="btn btn-default" ng-click="adminModel.orderCreatorName()">שם יוצר אירוע</button>
  <button class="btn btn-default" ng-click="adminModel.catalogSensitivities()">רגישויות</button>
  <button class="btn btn-default" ng-click="adminModel.fixExitListMeasurementUnit()">מידה</button>
  <button class="btn btn-default" ng-click="adminModel.categoryType(1)">category type order</button>
  <button class="btn btn-default" ng-click="adminModel.categoryType(2)">category type bid</button>
  <button class="btn btn-default" ng-click="adminModel.quoteDate()">quote date</button>
  <button class="btn btn-default" ng-click="adminModel.prodMu()">prod measurement unit</button>
  <button class="btn btn-default" ng-click="adminModel.totForStat()">tot for stat</button>
  <button class="btn btn-default" ng-click="adminModel.copyTasks()">copy tasks</button>
  <button class="btn btn-default" ng-click="adminModel.updateHeader()">header</button>
  <button class="btn btn-default" ng-click="adminModel.specialTypes()">special types</button>
  <button class="btn btn-default" ng-click="adminModel.listExtra()">list Extra</button>
    <button class="btn btn-default" ng-click="adminModel.packageFactor()">package factor</button>
   <button class="btn btn-default" ng-click="adminModel.isInStock()">stock</button>
 -->
</div>
 <tabset>
  <tab heading='מע"מ'>
    <label>שיעור מע"מ: </label>
    <input type="number" min="0" max="50" ng-change="adminModel.setVat()"
           ng-model-options="{updateOn: 'blur'}"
           ng-model="adminModel.vatRate"
           ng-class="adminModel.vatError?'bg-danger':null">
    <button class="btn btn-default" ng-click="adminModel.updateVat()">עדכן</button>
    <p></p>
    <div>יש לרענן את הדף (F5) אחרי השינוי</div>
  </tab>
   <tab heading="זיהוי אירועים">
     <table style="width:15%">
     <tr>
       <td><label>צבעים</label></td>
       <td><input type="checkbox" ng-model="adminModel.isOrderColors" ng-change="adminModel.setOrderIdent()"></td>
     </tr>
     <tr>
       <td><label>מספרים</label></td>
       <td><input type="checkbox" ng-model="adminModel.isOrderNumbers" ng-change="adminModel.setOrderIdent()"></td>
     </tr>
     </table>
     <p></p>
     <div>יש לרענן את הדף (F5) אחרי השינוי</div>
   </tab>
  <tab heading="שינוי סיסמה">
    <table>
      <tbody>
      <tr>
        <td><label>סיסמה חדשה: </label></td>
        <td><input type="password" size="8" ng-model="adminModel.pwd1"></td>
      </tr>
      <tr>
        <td><label>חזור על הסיסמה: </label></td>
        <td><input type="password" size="8" ng-model="adminModel.pwd2"></td>
      </tr>
      </tbody>
    </table>
    <button class="btn btn-default" ng-click="adminModel.setPwd()">עדכן</button>
  </tab>
  <tab heading="משתמשים">
    <table class="table table-hover">
      <thead>
      <th style="text-align: left">username</th>
      <th style="text-align: left">email</th>
      <th>sales?</th>
      <th>kitchen?</th>
      </thead>
      <tbody>
      <tr ng-repeat="user in adminModel.users track by user.id">
        <td style="text-align: left">{{user.attributes.username}}</td>
        <td style="text-align: left">{{user.attributes.email}}</td>
        <td>{{user.attributes.isSalesPerson}}</td>
        <td>{{user.attributes.isKitchenStaff}}</td>
        <td>
          <button class="btn btn-warning"
                  ng-hide="user.isInRole || adminModel.isUserRefresh"
                  ng-click="adminModel.addUserToRole(user)">
            add to role
          </button>
        </td>
        <td>
          <button class="btn btn-default btn-sm" ng-click="adminModel.resetPwd(user)">
            אפס סיסמה
          </button>
        </td>
      </tr>
      </tbody>
    </table>
    <div>
      <button class="btn btn-default" ng-click="adminModel.newUser()">משתמש חדש</button>
      <input type="text"
             ng-show="adminModel.isNewUser"
             ng-model="adminModel.user.attributes.username"
             placeholder="username">
      <input type="text"
             ng-show="adminModel.isNewUser"
             ng-model="adminModel.user.attributes.password"
             placeholder="password">
      <input type="text"
             ng-show="adminModel.isNewUser"
             ng-model="adminModel.user.attributes.email"
             placeholder="email">
      <span ng-show="adminModel.isNewUser">איש מכירות?</span>
      <input type="checkbox"
             ng-show="adminModel.isNewUser"
             ng-model="adminModel.user.attributes.isSalesPerson">
      <span ng-show="adminModel.isNewUser">צוות מטבח?</span>
      <input type="checkbox"
             ng-show="adminModel.isNewUser"
             ng-model="adminModel.user.attributes.isKitchenStaff">
      <button ng-show="adminModel.isNewUser"
              class="btn btn-primary btn-sm"
              ng-click="adminModel.createUser()">צור</button>
      <button ng-show="adminModel.isNewUser"
              class="btn btn-warning btn-sm"
              ng-click="adminModel.cancelNewUser()">בטל</button>
    </div>
    <!-- only first time
    <div>
      <button class="btn btn-default" ng-click="adminModel.createRole()">Role</button>
    </div>
    -->
  </tab>
  <tab heading="עץ מוצר" select="adminModel.productTreeInit()">
    <div ng-hide="adminModel.isCatalogLoading">
    <label>בחר קטגוריה</label>
    <select ng-model="adminModel.productTreeCategory"
            ng-change="adminModel.productTree()"
            ng-options="category.label for category in adminModel.categories"></select>
    <div>
      <div ng-repeat="menuItem in adminModel.menuItems track by menuItem.id">
        <div style="font-weight: bold;height: 0.6cm ; vertical-align: middle">
        <div style="cursor: pointer;width: 60%; display: inline-block"
             ng-click="adminModel.selectCatItem(menuItem.id)">
        <span>מנה:</span>
        <span>{{menuItem.properties.productName.substr(0,85)}}</span>
        </div>
        <div style="width: 30%; display: inline-block">
          <span>כמות ייצור</span>
          <span>{{menuItem.properties.productionQuantity}}</span>
          <span>{{menuItem.measurementUnit.label}}</span>
        </div>
        </div>
        <div ng-repeat="prep in menuItem.preparations track by prep.id" style="margin-right: 2%">
          <div style="color: red;height: 0.6cm ; vertical-align: middle">
          <div style="cursor: pointer;width: 40%; display: inline-block"
               ng-click="adminModel.selectCatItem(prep.id)">
          <span>הכנה:</span>
          <span ng-class="prep.properties.isDeleted?'myCanceledEvent':'null'">
            {{prep.properties.productName}}
          </span>
          </div>
          <div style="width: 18.4%;display: inline-block">
            <span>כמות במנה:</span>
            <span>{{prep.quantity}}</span>
            <span>{{prep.measurementUnit.label}}</span>
          </div>
          <div style="width: 20%;display: inline-block">
            <span>כמות יצור:</span>
            <span>{{prep.properties.productionQuantity}}</span>
            <span>{{prep.measurementUnit.label}}</span>
          </div>
          </div>
          <div ng-repeat="prepMaterial in prep.materials track by prepMaterial.id" style="margin-right: 3%">
            <div style="height: 0.6cm ; vertical-align: middle">
            <div style="cursor: pointer;width: 37.5%; display: inline-block"
                 ng-click="adminModel.selectCatItem(prepMaterial.id)">
            <span>חומר:</span>
            <span ng-class="prepMaterial.properties.isDeleted?'myCanceledEvent':'null'">
              {{prepMaterial.properties.productName}}
            </span>
            </div>
            <div style="width: 18.9%;display: inline-block">
              <span>כמות בהכנה:</span>
              <span>{{prepMaterial.quantity}}</span>
              <span>{{prepMaterial.measurementUnit.label}}</span>
            </div>
            </div>
          </div>
        </div>
        <div ng-repeat="material in menuItem.materials track by material.id" style="margin-right: 2%">
          <div style="height: 0.6cm ; vertical-align: middle">
          <div style="cursor: pointer;width: 40%; display: inline-block"
               ng-click="adminModel.selectCatItem(material.id)">
          <span>חומר:</span>
          <span ng-class="material.properties.isDeleted?'myCanceledEvent':'null'">
            {{material.properties.productName}}
          </span>
          </div>
          <div style="width: 18.4%;display: inline-block">
            <span>כמות במנה:</span>
            <span>{{material.quantity}}</span>
            <span>{{material.measurementUnit.label}}</span>
          </div>
          </div>
        </div>
        <div>&nbsp;</div>
      </div>
    </div>
    </div>
  </tab>
 <tab heading="מנות ללא פירוק" select="adminModel.catalogReport()">
   <h3>רשימת מנות שהיו באירועים בשנה האחרונה ושאין להם פירוק להכנות ומצרכים</h3>
    <table class="table table-hover" style="width: 70%">
      <th>קטגוריה</th>
      <th>שם</th>
      <th>אירועים</th>
      <tr ng-repeat="catItem in adminModel.catalog track by catItem.id">
        <td>{{catItem.view.category.label}}</td>
        <td style="cursor: pointer" ng-click="adminModel.selectCatItem(catItem.id)">
          {{catItem.properties.productName}}</td>
        <td>{{catItem.view.count}}</td>
      </tr>
    </table>
  </tab>
   <tab heading="עדכון קטגוריות">
     <div ng-hide="adminModel.isProcessing">
       <label>בחר תחום</label>
       <select ng-model="adminModel.productNamesDomain"
               ng-change="adminModel.filterProductNameDomain()"
               ng-options="domain.label for domain in adminModel.domains"></select>
       <label>בחר קטגוריה</label>
       <select ng-model="adminModel.productNamesCategory"
               ng-change="adminModel.filterProductNameCategory()"
               ng-options="category.label for category in adminModel.categories"></select>
       <table class="table table-hover" style="width: 99%">
         <thead>
         <th>שם</th>
         <th>כמות</th>
         <th>יח'</th>
         <th>ביטול</th>
         <th>קטגוריה</th>
         <th ng-repeat="sensitivity in adminModel.sensitivities track by sensitivity.tId"
             ng-show="adminModel.productNamesDomain.id===1">
           {{sensitivity.label}}
         </th>
         <th ng-show="adminModel.productNamesDomain.id>1">מלאי?</th>
         <th></th>
         </thead>
         <tbody>
         <tr ng-repeat="productNameItem in adminModel.productNameCategoryItems track by productNameItem.id"
             ng-class="productNameItem.errors ? 'bg-danger' :
                       productNameItem.isChanged ? 'bg-success' :
                       productNameItem.properties.isDeleted ? 'active myCanceledEvent' : bg-active">
           <td>{{productNameItem.properties.productName}}</td>
           <td>{{productNameItem.properties.priceQuantity}}</td>
           <td>{{productNameItem.measurementUnitLabel}}</td>
           <td>
             <input type="checkbox"
                    ng-model="productNameItem.properties.isDeleted"
                    ng-change="adminModel.productNameItemChanged(productNameItem)">
           </td>
           <td>
             <select ng-model="productNameItem.categoryObject"
                     ng-change="adminModel.productNameItemChanged(productNameItem)"
                     ng-options="category.label for category in adminModel.categories"></select>          </td>
           <td ng-repeat="potSens in productNameItem.sensArray track by potSens.tId"
               ng-show="adminModel.productNamesDomain.id===1">
             <input type="checkbox" ng-model="potSens.isTrue"
                    ng-change="adminModel.productNameItemChanged(productNameItem)">
           </td>
           <td ng-show="adminModel.productNamesDomain.id>1">
             <input type="checkbox" ng-model="productNameItem.properties.isInStock"
                    ng-change="adminModel.productNameItemChanged(productNameItem)">
           </td>
           <td>
             <button ng-show="productNameItem.isChanged"
                     ng-click="adminModel.saveProductNameitem(productNameItem)">
               עדכן
             </button>
           </td>
         </tr>
         </tbody>
       </table>
     </div>
   </tab>
   <tab heading="יח' מידה" select="adminModel.loadMenuItemsCatalog()">
     <div ng-hide="adminModel.isProcessing">
      <label>בחר קטגוריה</label>
       <select ng-model="adminModel.productNamesCategory"
               ng-change="adminModel.filterProductNameCategory()"
               ng-options="category.label for category in adminModel.categories"></select>
       <table class="table table-hover" style="width: 99%">
         <thead>
         <th>שם</th>
         <th>מידה ללקוח</th>
         <th>מידה לייצור</th>
         <th>מידה לאריזה</th>
         <th>פקטור ייצור</th>
         <th>פקטור אריזה</th>
         <th>פריטים נלווים</th>
        <th></th>
         </thead>
         <tbody>
         <tr ng-repeat="productNameItem in adminModel.productNameCategoryItems track by productNameItem.id"
             ng-class="productNameItem.errors ? 'bg-danger' :
                       productNameItem.isChanged ? 'bg-success' :
                       productNameItem.properties.isDeleted ? 'active myCanceledEvent' : bg-active">
           <td ng-hide="adminModel.isDisableLink">
             <a  ng-href="#/editCatalogItem/{{productNameItem.id}}">
               {{productNameItem.properties.productName}}
             </a>
           </td>
         <td ng-show="adminModel.isDisableLink">{{productNameItem.properties.productName}}</td>
        <td>
             <select ng-model="productNameItem.measurementUnit"
                     ng-change="adminModel.productNameItemChanged(productNameItem)"
                     ng-options="measurementUnit.label for measurementUnit in adminModel.measurementUnits"></select>
         </td>
           <td>
             <select ng-model="productNameItem.prodMeasurementUnit"
                     ng-change="adminModel.productNameItemChanged(productNameItem)"
                     ng-options="measurementUnit.label for measurementUnit in adminModel.measurementUnits"></select>
           </td>
           <td>
             <select ng-model="productNameItem.packageMeasurementUnit"
                     ng-change="adminModel.productNameItemChanged(productNameItem)"
                     ng-options="measurementUnit.label for measurementUnit in adminModel.measurementUnits"></select>
           </td>
           <td>
             <input type="number" min="1" max="9999" ng-model="productNameItem.properties.muFactor"
                    ng-change="adminModel.productNameItemChanged(productNameItem)">
           </td>
           <td>
             <input type="number" min="1" max="9999" ng-model="productNameItem.properties.packageFactor"
                    ng-change="adminModel.productNameItemChanged(productNameItem)">
           </td>
           <td ng-show="productNameItem.exitListLength">{{productNameItem.exitListLength}}</td>
           <td ng-hide="productNameItem.exitListLength"></td>
           <td>
           <button ng-show="productNameItem.isChanged"
                     ng-click="adminModel.saveProductNameitem(productNameItem)">
               עדכן
             </button>
           </td>
         </tr>
         </tbody>
       </table>
     </div>
   </tab>
   <tab heading="קופסאות" select="adminModel.loadNoBoxes()">
     <h3>חטיפים וקינוחים שאין להם קישור לקופסת פומפידו בעץ המוצר</h3>
     <table class="table table-hover">
      <tr ng-repeat="product in adminModel.noBoxes track by product.id">
        <td style="cursor: pointer" ng-click="adminModel.selectCatItem(product.id)">
          {{product.properties.productName}}
        </td>
      </tr>
     </table>
   </tab>
   <tab heading="לקוחות" select="adminModel.loadCustomers()">
     <div>
       <label>ליצוא</label>
       <input type="checkbox" ng-model="adminModel.isCustomersExport">
     </div>
     <table class="table table-hover" ng-hide="adminModel.isCustomersExport">
       <thead>
       <th>שם</th>
       <th>דואל</th>
       <th>טלפון</th>
       <th>מס' הצלחות</th>
       <th>מס' כשלונות</th>
       <th>אירוע אחרון</th>
       </thead>
       <tbody>
       <tr ng-repeat="customer in adminModel.customers track by customer.id">
         <td>{{customer.properties.firstName+' '+customer.properties.lastName}}</td>
         <td>{{customer.properties.email}}</td>
         <td>{{customer.properties.mobilePhone}}</td>
         <td>{{customer.view.noOfSuccesses}}</td>
         <td>{{customer.view.noOfFailures}}</td>
         <td>{{customer.view.lastEventDate | date:'dd/MM/yyyy'}}</td>
         <td></td>
       </tr>
       </tbody>
     </table>
     <div ng-show="adminModel.isCustomersExport">
       <div>
         <span>name,email,phone,successes,failures,lastEvent</span>
       </div>
       <div ng-repeat="customer in adminModel.customers track by customer.id">
         <span>{{customer.properties.firstName+' '+customer.properties.lastName}}</span>
         <span>,</span>
         <span>{{customer.properties.email}}</span>
         <span>,'</span>
         <span>{{customer.properties.mobilePhone}}</span>
         <span>,</span>
         <span>{{customer.view.noOfSuccesses}}</span>
         <span>,</span>
         <span>{{customer.view.noOfFailures}}</span>
         <span>,</span>
         <span>{{customer.view.lastEventDate | date:'dd/MM/yyyy'}}</span>
       </div>
     </div>
   </tab>
   <tab heading="מבצע" select="adminModel.loadCustomers2()">
     <div>
       <h3>לקוחות שסגרו אירוע בעבר ואין להם אירוע עתידי</h3>
       <label>ליצוא</label>
       <input type="checkbox" ng-model="adminModel.isCustomersExport">
     </div>
     <table class="table table-hover" ng-hide="adminModel.isCustomersExport">
       <thead>
       <th>שם</th>
       <th>דואל</th>
       <th>טלפון</th>
       <th>הצלחות עבר</th>
       <th>אירועי עתיד</th>
       <th>אירוע אחרון</th>
       </thead>
       <tbody>
       <tr ng-repeat="customer in adminModel.customers track by customer.id">
         <td>{{customer.properties.firstName+' '+customer.properties.lastName}}</td>
         <td>{{customer.properties.email}}</td>
         <td>{{customer.properties.mobilePhone}}</td>
         <td>{{customer.view.pastSuccesses}}</td>
         <td>{{customer.view.futureOrders}}</td>
         <td>{{customer.view.lastEventDate | date:'dd/MM/yyyy'}}</td>
         <td></td>
       </tr>
       </tbody>
     </table><!--
     <div ng-show="adminModel.isCustomersExport">
       <div>
         <span>name,email,phone,pastSuccesses,futureOrders,lastEvent</span>
       </div>
       <div ng-repeat="customer in adminModel.customers">
         <span>{{customer.properties.firstName+' '+customer.properties.lastName}}</span>
         <span>,</span>
         <span>{{customer.properties.email}}</span>
         <span>,'</span>
         <span>{{customer.properties.mobilePhone}}</span>
         <span>,</span>
         <span>{{customer.view.pastSuccesses}}</span>
         <span>,</span>
         <span>{{customer.view.futureOrders}}</span>
         <span>,</span>
         <span>{{customer.view.lastEventDate | date:'dd/MM/yyyy'}}</span>
       </div>
     </div>
     -->
     <div ng-show="adminModel.isCustomersExport">
       <div>
         <span>phone,firstName</span>
       </div>
       <div ng-repeat="customer in adminModel.customers track by customer.id">
         <span>{{customer.properties.mobilePhone}}</span>
         <span>,</span>
         <span>{{customer.properties.firstName}}</span>
     </div>
     </div>
   </tab>
   <tab heading="סביבה" active="adminModel.isEnvTabActive">
    <div>
      <span>סביבה נוכחית היא </span>
      <span>{{environment}}</span>
    </div>
    <div>
      <button class="btn btn-default" ng-click="adminModel.switchEnv()">שנה</button>
    </div>
     <p></p>
     <div>
       <button class="btn btn-warning"
               ng-click="adminModel.copyTasks()" ng-hide="environment==='test'">העתק הגדרת משימות לייצור</button>
     </div>
  </tab>
</tabset>
</div>
