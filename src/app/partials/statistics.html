<h3>סטטיסטיקות של אירועים</h3>
<div>
  <table>
    <tbody>
    <tr>
      <td>
        <label>אוכסוליה:</label>
      </td>
      <td>
        <label>תאריך יצירה</label>
        <input type="radio" ng-model="statisticsModel.filterBy" value="createdAt">
      </td>
      <td>
        <label>תאריך אירוע</label>
        <input type="radio" ng-model="statisticsModel.filterBy" value="eventDate">
      </td>
      <td>
        <label>מתאריך</label>
        <input type="date" ng-model="statisticsModel.fromDate">
      </td>
      <td>
        <label>עד תאריך</label>
        <input type="date" ng-model="statisticsModel.toDate">
      </td>
      <td>
        <button class="btn btn-default" ng-click="statisticsModel.loadOrders()">טען</button>
      </td>
    </tr>
    <tr>
      <td><label>סינון:</label></td>
      <td>
        <label>מסכום</label>
        <input type="text" size="7" money
               ng-model="statisticsModel.fromTotal"
               ng-change="statisticsModel.filterOrders()">
      </td>
      <td>
        <label>עד סכום</label>
        <input type="text" size="7" money
               ng-model="statisticsModel.toTotal"
               ng-change="statisticsModel.filterOrders()">
      </td>
      <td>
        <label>ממשתתפים</label>
        <input type="number" size="1" min="0" max="10000"
               ng-model="statisticsModel.fromParticipants"
               ng-change="statisticsModel.filterOrders()">
      </td>
      <td>
        <label>עד משתתפים</label>
        <input type="number" size="1"  min="0" max="10000"
               ng-model="statisticsModel.toParticipants"
               ng-change="statisticsModel.filterOrders()">
      </td>
      <td>
        <label>ליצוא</label>
        <input type="checkbox" ng-model="statisticsModel.isForExport">
      </td>
    </tr>
     </tbody>
  </table>
  <tabset>
    <tab heading="חודש" deselect="statisticsModel.deselectTab(statisticsModel.monthStats)">
      <div ng-hide="statisticsModel.isForExport">
        <table class="table table-hover" style="width: 80%">
          <thead ng-show="statisticsModel.monthStats.length">
          <th><label>חודש</label></th>
          <th><label>מס' פוט'</label></th>
          <th><label>סכום פוט'</label></th>
          <th><label>ממוצע לאירוע</label></th>
          <th><label>מס' בפועל</label></th>
          <th><label>% בפועל</label></th>
          <th><label>סכום בפועל</label></th>
          <th><label>ממוצע לאירוע</label></th>
          <th><label>מס' משתתפים</label></th>
          <th><label>מחיר לאורח</label></th>
          <th><label>משלוחים</label></th>
          </thead>
          <tbody>
          <tr ng-repeat="line in statisticsModel.monthStats track by line.label"
              ng-class="line.isBold?'bg-warning':null">
            <td style="cursor: pointer"
                ng-click="statisticsModel.setupLineOrders(statisticsModel.monthStats,line)">{{line.label | date: 'MM.yy'}}</td>
            <td>{{line.potCount}}</td>
            <td>{{line.potTotal | currency}}</td>
            <td>{{line.potTotal / line.potCount | currency}}</td>
            <td>{{line.actCount}}</td>
            <td>{{(line.actCount / line.potCount) * 100 | number:1}}</td>
            <td>{{line.actTotal | currency}}</td>
            <td>{{line.actTotal / line.actCount | currency}}</td>
            <td>{{line.actParticipants / line.actCount | number:1}}</td>
            <td>{{line.actTotal / line.actParticipants | currency}}</td>
            <td>{{line.actTransportation | currency}}</td>
          </tr>
          <tr><td></td></tr>
          <tr ng-show="statisticsModel.monthStats.length">
            <td><label>ס"ה</label></td>
            <td>{{statisticsModel.monthTot.potCount}}</td>
            <td>{{statisticsModel.monthTot.potTotal | currency}}</td>
            <td></td>
            <td>{{statisticsModel.monthTot.actCount}}</td>
            <td>{{(statisticsModel.monthTot.actCount / statisticsModel.monthTot.potCount) * 100 | number:1}}</td>
            <td>{{statisticsModel.monthTot.actTotal | currency}}</td>
            <td></td>
            <td></td>
            <td></td>
            <td>{{statisticsModel.monthTot.actTransportation | currency}}</td>
          </tr>
          <tr ng-show="statisticsModel.monthStats.length">
            <td><label>ממוצע</label></td>
            <td>{{statisticsModel.monthAvg.potCount | number:2}}</td>
            <td>{{statisticsModel.monthAvg.potTotal | currency}}</td>
            <td>{{statisticsModel.monthAvg.potTotal / statisticsModel.monthAvg.potCount | currency}}</td>
            <td>{{statisticsModel.monthAvg.actCount | number:2}}</td>
            <td>{{(statisticsModel.monthAvg.actCount / statisticsModel.monthAvg.potCount) * 100 | number:1}}</td>
            <td>{{statisticsModel.monthAvg.actTotal | currency}}</td>
            <td>{{statisticsModel.monthAvg.actTotal / statisticsModel.monthAvg.actCount | currency}}</td>
            <td>{{statisticsModel.monthAvg.actParticipants / statisticsModel.monthAvg.actCount | number:1}}</td>
            <td>{{statisticsModel.monthTot.actTotal / statisticsModel.monthTot.actParticipants | currency}}</td>
            <td>{{statisticsModel.monthAvg.actTransportation | currency}}</td>
          </tr>
          </tbody>
        </table>
      </div>
      <div ng-show="statisticsModel.isForExport">
        <p></p>
        <div ng-repeat="line in statisticsModel.monthStats track by line.label">
          <span>{{line.label | date: 'MM/yy'}}</span>
          <span>,</span>
          <span>{{line.potCount }}</span>
          <span>,</span>
          <span>{{line.potTotal }}</span>
          <span>,</span>
          <span>{{line.actCount }}</span>
          <span>,</span>
          <span>{{line.actTotal }}</span>
        </div>
      </div>
    </tab>
    <tab heading="משתתפים" deselect="statisticsModel.deselectTab(statisticsModel.participantStats)">
    <table class="table table-hover" style="width: 80%">
        <thead ng-show="statisticsModel.participantStats.length">
        <th><label>משתתפים</label></th>
        <th><label>מס' פוט'</label></th>
        <th><label>סכום פוט'</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' בפועל</label></th>
        <th><label>% בפועל</label></th>
        <th><label>סכום בפועל</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' משתתפים</label></th>
        <th><label>מחיר לאורח</label></th>
        <th><label>משלוחים</label></th>
        </thead>
        <tbody>
        <tr ng-repeat="line in statisticsModel.participantStats track by line.label"
            ng-class="line.isBold?'bg-warning':null">
          <td style="cursor: pointer"
              ng-click="statisticsModel.setupLineOrders(statisticsModel.participantStats,line)">{{line.label}}</td>
          <td>{{line.potCount}}</td>
          <td>{{line.potTotal | currency}}</td>
          <td>{{line.potTotal / line.potCount | currency}}</td>
          <td>{{line.actCount}}</td>
          <td>{{(line.actCount / line.potCount) * 100 | number:1}}</td>
          <td>{{line.actTotal | currency}}</td>
          <td>{{line.actTotal / line.actCount | currency}}</td>
          <td>{{line.actParticipants / line.actCount | number:1}}</td>
          <td>{{line.actTotal / line.actParticipants | currency}}</td>
          <td>{{line.actTransportation | currency}}</td>
        </tr>
        <tr><td></td></tr>
        <tr ng-show="statisticsModel.participantStats.length">
          <td><label>ס"ה</label></td>
          <td>{{statisticsModel.participantTot.potCount}}</td>
          <td>{{statisticsModel.participantTot.potTotal | currency}}</td>
          <td></td>
          <td>{{statisticsModel.participantTot.actCount}}</td>
          <td>{{(statisticsModel.participantTot.actCount / statisticsModel.participantTot.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.participantTot.actTotal | currency}}</td>
          <td></td>
          <td></td>
          <td></td>
          <td>{{statisticsModel.participantTot.actTransportation | currency}}</td>
        </tr>
        <tr ng-show="statisticsModel.participantStats.length">
          <td><label>ממוצע</label></td>
          <td>{{statisticsModel.participantAvg.potCount | number:2}}</td>
          <td>{{statisticsModel.participantAvg.potTotal | currency}}</td>
          <td>{{statisticsModel.participantAvg.potTotal / statisticsModel.participantAvg.potCount | currency}}</td>
          <td>{{statisticsModel.participantAvg.actCount | number:2}}</td>
          <td>{{(statisticsModel.participantAvg.actCount / statisticsModel.participantAvg.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.participantAvg.actTotal | currency}}</td>
          <td>{{statisticsModel.participantAvg.actTotal / statisticsModel.participantAvg.actCount | currency}}</td>
          <td>{{statisticsModel.participantAvg.actParticipants / statisticsModel.participantAvg.actCount | number:1}}</td>
          <td>{{statisticsModel.participantTot.actTotal / statisticsModel.participantTot.actParticipants | currency}}</td>
          <td>{{statisticsModel.participantTot.actTransportation | currency}}</td>
        </tr>
        </tbody>
      </table>
    </tab>
    <tab heading="סכום" deselect="statisticsModel.deselectTab(statisticsModel.totalStats)">
      <table class="table table-hover" style="width: 80%">
        <thead ng-show="statisticsModel.totalStats.length">
        <th><label>סכום</label></th>
        <th><label>מס' פוט'</label></th>
        <th><label>סכום פוט'</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' בפועל</label></th>
        <th><label>% בפועל</label></th>
        <th><label>סכום בפועל</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' משתתפים</label></th>
        <th><label>מחיר לאורח</label></th>
        <th><label>משלוחים</label></th>
        </thead>
        <tbody>
        <tr ng-repeat="line in statisticsModel.totalStats track by line.label"
            ng-class="line.isBold?'bg-warning':null">
          <td style="cursor: pointer"
              ng-click="statisticsModel.setupLineOrders(statisticsModel.totalStats,line)">{{line.label}}</td>
          <td>{{line.potCount}}</td>
          <td>{{line.potTotal | currency}}</td>
          <td>{{line.potTotal / line.potCount | currency}}</td>
          <td>{{line.actCount}}</td>
          <td>{{(line.actCount / line.potCount) * 100 | number:1}}</td>
          <td>{{line.actTotal | currency}}</td>
          <td>{{line.actTotal / line.actCount | currency}}</td>
          <td>{{line.actParticipants / line.actCount | number:1}}</td>
          <td>{{line.actTotal / line.actParticipants | currency}}</td>
          <td>{{line.actTransportation | currency}}</td>
        </tr>
        <tr><td></td></tr>
        <tr ng-show="statisticsModel.totalStats.length">
          <td><label>ס"ה</label></td>
          <td>{{statisticsModel.totalTot.potCount}}</td>
          <td>{{statisticsModel.totalTot.potTotal | currency}}</td>
          <td></td>
          <td>{{statisticsModel.totalTot.actCount}}</td>
          <td>{{(statisticsModel.totalTot.actCount / statisticsModel.totalTot.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.totalTot.actTotal | currency}}</td>
          <td></td>
          <td></td>
          <td></td>
          <td>{{statisticsModel.totalTot.actTransportation | currency}}</td>
        </tr>
        <tr ng-show="statisticsModel.totalStats.length">
          <td><label>ממוצע</label></td>
          <td>{{statisticsModel.totalAvg.potCount | number:2}}</td>
          <td>{{statisticsModel.totalAvg.potTotal | currency}}</td>
          <td>{{statisticsModel.totalAvg.potTotal / statisticsModel.totalAvg.potCount | currency}}</td>
          <td>{{statisticsModel.totalAvg.actCount | number:2}}</td>
          <td>{{(statisticsModel.totalAvg.actCount / statisticsModel.totalAvg.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.totalAvg.actTotal | currency}}</td>
          <td>{{statisticsModel.totalAvg.actTotal / statisticsModel.totalAvg.actCount | currency}}</td>
          <td>{{statisticsModel.totalAvg.actParticipants / statisticsModel.totalAvg.actCount | number:1}}</td>
          <td>{{statisticsModel.totalTot.actTotal / statisticsModel.totalTot.actParticipants | currency}}</td>
          <td>{{statisticsModel.totalTot.actTransportation | currency}}</td>
        </tr>
        </tbody>
      </table>
    </tab>
    </tab>
    <tab heading="הפניה" deselect="statisticsModel.deselectTab(statisticsModel.referralSourceStats)">
      <table class="table table-hover" style="width: 80%">
        <thead ng-show="statisticsModel.referralSourceStats.length">
        <th><label>הפניה</label></th>
        <th><label>מס' פוט'</label></th>
        <th><label>סכום פוט'</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' בפועל</label></th>
        <th><label>% בפועל</label></th>
        <th><label>סכום בפועל</label></th>
        <th><label>ממוצע לאירוע</label></th>
        <th><label>מס' משתתפים</label></th>
        <th><label>מחיר לאורח</label></th>
        <th><label>משלוחים</label></th>
        </thead>
        <tbody>
        <tr ng-repeat="line in statisticsModel.referralSourceStats track by line.label"
            ng-class="line.isBold?'bg-warning':null">
          <td style="cursor: pointer"
              ng-click="statisticsModel.setupLineOrders(statisticsModel.referralSourceStats,line)">{{line.label}}</td>
          <td>{{line.potCount}}</td>
          <td>{{line.potTotal | currency}}</td>
          <td>{{line.potTotal / line.potCount | currency}}</td>
          <td>{{line.actCount}}</td>
          <td>{{(line.actCount / line.potCount) * 100 | number:1}}</td>
          <td>{{line.actTotal | currency}}</td>
          <td>{{line.actTotal / line.actCount | currency}}</td>
          <td>{{line.actParticipants / line.actCount | number:1}}</td>
          <td>{{line.actTotal / line.actParticipants | currency}}</td>
          <td>{{line.actTransportation | currency}}</td>
        </tr>
        <tr><td></td></tr>
        <tr ng-show="statisticsModel.referralSourceStats.length">
          <td><label>ס"ה</label></td>
          <td>{{statisticsModel.referralSourceTot.potCount}}</td>
          <td>{{statisticsModel.referralSourceTot.potTotal | currency}}</td>
          <td></td>
          <td>{{statisticsModel.referralSourceTot.actCount}}</td>
          <td>{{(statisticsModel.referralSourceTot.actCount / statisticsModel.referralSourceTot.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.referralSourceTot.actTotal | currency}}</td>
          <td></td>
          <td></td>
          <td></td>
          <td>{{statisticsModel.referralSourceTot.actTransportation | currency}}</td>
        </tr>
        <tr ng-show="statisticsModel.referralSourceStats.length">
          <td><label>ממוצע</label></td>
          <td>{{statisticsModel.referralSourceAvg.potCount | number:2}}</td>
          <td>{{statisticsModel.referralSourceAvg.potTotal | currency}}</td>
          <td>{{statisticsModel.referralSourceAvg.potTotal / statisticsModel.referralSourceAvg.potCount | currency}}</td>
          <td>{{statisticsModel.referralSourceAvg.actCount | number:2}}</td>
          <td>{{(statisticsModel.referralSourceAvg.actCount / statisticsModel.referralSourceAvg.potCount) * 100 | number:1}}</td>
          <td>{{statisticsModel.referralSourceAvg.actTotal | currency}}</td>
          <td>{{statisticsModel.referralSourceAvg.actTotal / statisticsModel.referralSourceAvg.actCount | currency}}</td>
          <td>{{statisticsModel.referralSourceAvg.actParticipants / statisticsModel.referralSourceAvg.actCount | number:1}}</td>
          <td>{{statisticsModel.referralSourceTot.actTotal / statisticsModel.referralSourceTot.actParticipants | currency}}</td>
          <td>{{statisticsModel.referralSourceTot.actTransportation | currency}}</td>
        </tr>
        </tbody>
      </table>
    </tab>
  </tabset>
  <div ng-hide="statisticsModel.isHideOrders">
    <h4>פירוט אירועים:</h4>
  <ng-include src="'app/partials/order/orderTable.html'"></ng-include>
  </div>
</div>
